<!DOCTYPE html>
<html lang="" xml:lang="">
  <head>
    <title>Análisis de Datos Categóricos (SOL3070)</title>
    <meta charset="utf-8" />
    <meta name="author" content="  Mauricio Bucca  Profesor Asistente, Sociología UC" />
    <script src="libs/header-attrs-2.3/header-attrs.js"></script>
    <link href="libs/remark-css-0.0.1/default.css" rel="stylesheet" />
    <link href="libs/remark-css-0.0.1/default-fonts.css" rel="stylesheet" />
    <link rel="stylesheet" href="gentle-r.css" type="text/css" />
  </head>
  <body>
    <textarea id="source">
class: center, middle, inverse, title-slide

# Análisis de Datos Categóricos (SOL3070)
## Clase #2
### <br> Mauricio Bucca<br> Profesor Asistente, Sociología UC
### <a href="https://github.com/mebucca">github.com/mebucca</a>

---

class: inverse, center, middle

#Probabilidades (continuación)

---

### Probabilidad condicional

.bold[Probabilidad condicional] es un concepto crucial en teoría de la probabilidad y subyace al propósito principal del análisis de regresión logística.
--
 La probabilidad de un evento A después de que nos enteramos de que se ha producido el evento B se denomina probabilidad condicional de A dado B. Formalmente:

`$$\mathbb{P}(A \mid B)$$`
--

Ejemplo:
- Experimento: tirar un dado "justo"
- Espacio muestral, `\(\Omega: \{1,2,3,4,5,6\}\)`
- A es el evento de obtener un cuatro o más,  `\(A: \{4,5,6\}\)`.
- B es el evento de obtener un número par, `\(B: \{2,4,6\}\)`.

Supongamos que tiramos el dado pero no miramos el resultado todavía. Una tercera persona nos dice que obtuvimos un número par.

--
.full-width[.content-box-red[
.bold[Pregunta]:
¿cuál es la probabilidad de obtener un cuatro o más una vez que sabemos que el resultado es un número?
]
]

---

### Probabilidad condicional

Formalmente, nuestra pregunta se expresa del siguiente modo: `\(\mathbb{P}(A \mid B )\)`. Para calcular esta probabilidad utilizamos la siguiente fórmula:

`$$\mathbb{P}(A \mid B ) = \frac{\mathbb{P}(A,B)}{\mathbb{P}(B)}$$`
Intuitivamente, queremos saber en qué proporción de los casos en que B ocurre, A también ocurre. 

---
### Probabilidad condicional

`$$\mathbb{P}(A \mid B ) = \frac{\mathbb{P}(A,B)}{\mathbb{P}(B)}$$`

Donde,
- `\(\mathbb{P}(B)\)` es la probabilidad de que B ocurra: obtener un número .bold[par]
- `\(\mathbb{P}(A,B)\)` es la probabilidad  A y B ocurran conjuntamente: obtener un número .bold[par, igual o superior a 4]

&lt;br&gt;
--

`\begin{align}
\mathbb{P}(A | B ) &amp;= \frac{\mathbb{P}(A,B)}{\mathbb{P}(B)} \\ \\
&amp;= \frac{\mathbb{P}(\text{dado=4 o dado=6}) }{\mathbb{P}(\text{dado=2 o dado=4 o dado=6})} \\ \\
&amp;=  \frac{2/6}{3/6} = \frac{1}{3} \times 2
\end{align}`


---
### Probabilidad condicional


.bold[Ejercicio rápido]:

Supongamos que:
- Un 5% de población son mujeres (M) con un estudios universitarios completos (U)
- Las mujeres representan 55% de la población
- Un 20% de la población tiene estudios universitarios completos

--

.full-width[.content-box-red[
.bold[Pregunta]:
1) Cual es la probabilidad de que una mujer tenga estudios universitarios completos?
]
]

--

.full-width[.content-box-blue[
.bold[Respuesta]:

1) 
`\begin{align}
\mathbb{P}(U \mid M) = \frac{\mathbb{P}(U,M)}{\mathbb{P}(M)} = \frac{0.05}{0.55} \approx  0.09
\end{align}`
]
]

---

### Probabilidad condicional

.bold[Ejercicio rápido]:

Supongamos que:
- Un 5% de población son mujeres (M) con un estudios universitarios completos (U)
- Las mujeres representan 55% de la población
- Un 20% de la población tiene estudios universitarios completos


.full-width[.content-box-red[
.bold[Pregunta]:
2) Cual es la probabilidad de que una persona con estudios universitarios completos sea mujer?
]
]

--

.full-width[.content-box-blue[
.bold[Respuesta]:

2) 
`\begin{align}
\mathbb{P}(M \mid U) = \frac{\mathbb{P}(U,M)}{\mathbb{P}(U)} = \frac{0.05}{0.2} = 0.25
\end{align}`
]
]


---

### Probabilidad condicional

.bold[Ejercicio rápido]:

Supongamos que:
- Un 5% de población son mujeres (M) con un estudios universitarios completos (U)
- Las mujeres representan 55% de la población
- Un 20% de la población tiene estudios universitarios completos


.full-width[.content-box-red[
.bold[Pregunta]:
3) Cual es la probabilidad de que una persona con estudios universitarios completos sea hombre?
]
]

--

.full-width[.content-box-blue[
.bold[Respuesta]:

1) 
`\begin{align}
\mathbb{P}(H \mid U) = \frac{\mathbb{P}(U,H)}{\mathbb{P}(U)} = 1- \mathbb{P}(M | U) = 1 - 0.25 = 0.75 
\end{align}`
]
]


---
### Probabilidad condicional

.full-width[.content-box-red[
.bold[Bonus]:

4) Cual es la probabilidad de que un hombre tenga estudios universitarios completos?

]
]

.bold[Pista]: En general,
$$ \mathbb{P}(A | B) \neq \mathbb{P}(B | A)  $$
&lt;br&gt;
pero el .bold[Teorema de Bayes] nos dice cómo transformar uno en el otro.

---
### Teorema de Bayes


La probabilidad de A dado B está definida como:

`$$\mathbb{P}(A \mid B) = \frac{\mathbb{P}(A,B)}{\mathbb{P}(B)} \quad \quad \quad \quad \quad (1)$$`
&lt;br&gt;
--

Por tanto, La probabilidad de B dado A está definida como:

`$$\mathbb{P}(B \mid A) = \frac{\mathbb{P}(A,B)}{\mathbb{P}(A)} \quad \quad \quad \quad \quad (2)$$`
&lt;br&gt;
--

Por tanto: 

`$$\mathbb{P}(A,B) = \mathbb{P}(B \mid A)\mathbb{P}(A) \quad \quad \quad \quad  (3)$$`
&lt;br&gt;
--

Reemplazando (3) en (1) obtenemos:


$$\mathbb{P}(A \mid B) = \frac{\mathbb{P}(B \mid A)\mathbb{P}(A)}{\mathbb{P}(B)} \quad \quad \quad \quad \quad $$

---
### Teorema de Bayes

Entonces, si

$$\mathbb{P}(A \mid B) = \frac{\mathbb{P}(B \mid A)\mathbb{P}(A)}{\mathbb{P}(B)} \quad \quad \quad \quad \quad $$


&lt;br&gt;
re-ordenando la expresión encontramos ...

&lt;br&gt;
--


.full-width[.content-box-blue[
.bold[Teorema de Bayes]:
$$\mathbb{P}(B \mid A) = \frac{\mathbb{P}(A \mid B)\mathbb{P}(B)}{\mathbb{P}(A)} \quad \quad \quad \quad \quad $$
]
]

---
class: fullscreen,left, top, top, text-white
background-image: url(bayes.jpg)

---
### Teorema de Bayes en práctica

.bold[Ejercicio rápido]:

- Un 5% de población son mujeres (M) con un estudios universitarios completos (U)
- Las mujeres representan 55% de la población
- Un 20% de la población tiene estudios universitarios completos


.full-width[.content-box-red[
.bold[Bonus]:
4) Cual es la probabilidad de que un hombre tenga estudios universitarios completos?
]
]
.full-width[.content-box-blue[
.bold[Respuesta]:

4) 
`\begin{align}
\mathbb{P}(U \mid H) = \frac{\mathbb{P}(H \mid U)\mathbb{P}(U)}{\mathbb{P}(H)} =   \frac{0.75 \times 0.2}{0.45} = 0.333
\end{align}`
]
]

---
### Ley de "probabilidad total"

Si `\(\{B_{1}, B_{2}., \dots, B_{n}\}\)` es un conjunto de particiones "desunidas" y mutuamente excluyentes del espacio muestral, entonces:

`\begin{align}
\mathbb{P}(A) = \sum_{i=1}^{n}\mathbb{P}(A,B_{i})
\end{align}`

&lt;br&gt;
--

dado que, como vimos, `\(\mathbb{P}(A,B) = \mathbb{P}(A \mid B)\mathbb{P}(B)\)`, entonces ...

&lt;br&gt;
--

`\begin{align}
\mathbb{P}(A) = \sum_{i=1}^{n}\mathbb{P}(A \mid B_{i})\mathbb{P}(B_{i})
\end{align}`

---
### Ley de "probabilidad total"

.bold[Ejercicio rápido]:


- Las mujeres (M) representan 55% de la población
- El 20% de los hombres (H) tiene estudios universitarios completos (U)
- El 25% de las mujeres tiene estudios universitarios completos

--

.content-box-red[
.bold[Pregunta]:
Cual es la probabilidad de tener estudios universitarios completos?
]

--

.content-box-blue[
.bold[Respuesta]:
`\begin{align}
\mathbb{P}(U) &amp;= \mathbb{P}(U \mid H)\mathbb{P}(H) + \mathbb{P}(U \mid M)\mathbb{P}(M) \\ \\
              &amp;= 0.2 \times 0.45 + 0.25 \times 0.55 \\ \\
              &amp;= 0.2275
\end{align}`

]

---
### Independencia

Dos eventos A y B son .bold[independientes] cuando la ocurrencia de A no afecta la ocurrencia de B y viceversa. 
--
Independencia es una caso especial de probabilidad condicional: `\(A \bot B\)` si el conocimiento sobre B no cambia nuestro conocimiento sobre A. Formalmente:

`$$\mathbb{P}(A | B) = \mathbb{P}(A) \quad \iff \quad \mathbb{P}(B | A) = \mathbb{P}(B)$$` 
&lt;br&gt;
--
A partir de esta definición podemos derivar un test matemático de independencia:

&lt;br&gt;

`\begin{align}
  &amp;\mathbb{P}(A | B) = \mathbb{P}(A) \\ \\
  &amp;\frac{\mathbb{P}(A,B)}{\mathbb{P}(B)} = \mathbb{P}(A) \\  \\
  &amp;\mathbb{P}(A,B) = \mathbb{P}(A)\mathbb{P}(B) 
\end{align}`

&lt;br&gt;
--
Si dos eventos A y B son independientes entonces debe ser cierto que `\(\mathbb{P}(A,B)=\mathbb{P}(A)(B)\)`.

---
### Independencia

Ejemplo:
- Experimento: lanzar dos monedas justas consecutivamente. 
- A es el evento de obtener una Cara con la primera moneda
- B es el evento de obtener Sello con la segunda moneda. 

.full-width[.content-box-red[
.bold[Pregunta]:
Son A y B dos eventos independientes?
]
]

--

.pull-left[
.full-width[.content-box-blue[
.bold[Sabemos que...]
- `\(\mathbb{P}(A) = \mathbb{P}(B) = 1/2\)`

- `\(\Omega: \{CC,CS,SC,SS\}\)`

- `\((A,B) = \{CS\}\)`

- `\(\mathbb{P}(A,B) = 1/4\)`

]
]
]

--

.pull-right[
.full-width[.content-box-blue[
.bold[Test de independencia]

Si A y B son eventos independientes entonces deberiamos espera que `\(\mathbb{P}(A)\mathbb{P}(B) = 1/4\)`

`\begin{align}
\mathbb{P}(A)\mathbb{P}(B) = \frac{1}{2} \times \frac{1}{2} = \frac{1}{4}
\end{align}`
]
]
]

---
### Independencia

.bold[Ilustración via Monte Carlo Simulation] .footnote[[1] En su versión más simple posible!]

.center[
![mc](montecarlo.jpg)
]

---

### Independencia

.bold[Ilustración via Monte Carlo Simulation]

Experimento: Tiramos dos moneda simultáneamente, una justa y una moneda sesgada (90% prob. Cara). 

--

Si ambas lanzamientos son efectivamente independientes la probabilidad de obtener dos caras debiera ser: `\(\mathbb{P}(C_{1}C_{2}) = \mathbb{P}(C_{1})\mathbb{P}(C_{2}) = 0.5 \times 0.9 = 0.45\)`

--

.pull-left[


```r
# lanzamos ambas moneda 100000 veces
coin1 &lt;- rbinom(100000,1, prob = 0.5)
coin2 &lt;- rbinom(100000,1, prob = 0.9)

glimpse(coin1)
```

```
##  int [1:100000] 1 1 0 0 1 1 1 0 1 1 ...
```

```r
#  probabilidad de obtener cara
p1 = mean(coin1)
p2 = mean(coin2); print(c(p1=p1, p2=p2))
```

```
##      p1      p2 
## 0.50096 0.90023
```
]

--

.pull-right[

```r
# definimos evento exitoso: dos caras
cc &lt;- ifelse(coin1==1 &amp; coin2==1,1,0)

#  probabilidad de obtener 2 caras
p_cc = mean(cc); p_cc
```

```
## [1] 0.45097
```

```r
# test independencia
p1*p2
```

```
## [1] 0.4509792
```
]

---
class: inverse, center, middle

.huge[
**Hasta la próxima clase. Gracias!**
]

&lt;br&gt;
Mauricio Bucca &lt;br&gt;
https://mebucca.github.io/ &lt;br&gt;
github.com/mebucca




    </textarea>
<style data-target="print-only">@media screen {.remark-slide-container{display:block;}.remark-slide-scaler{box-shadow:none;}}</style>
<script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
<script>var slideshow = remark.create({
"ratio": "16:9",
"highlightStyle": "github",
"highlightLines": true,
"countIncrementalSlides": true,
"slideNumberFormat": "%current%"
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function(d) {
  var s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})(document);

(function(d) {
  var el = d.getElementsByClassName("remark-slides-area");
  if (!el) return;
  var slide, slides = slideshow.getSlides(), els = el[0].children;
  for (var i = 1; i < slides.length; i++) {
    slide = slides[i];
    if (slide.properties.continued === "true" || slide.properties.count === "false") {
      els[i - 1].className += ' has-continuation';
    }
  }
  var s = d.createElement("style");
  s.type = "text/css"; s.innerHTML = "@media print { .has-continuation { display: none; } }";
  d.head.appendChild(s);
})(document);
// delete the temporary CSS (for displaying all slides initially) when the user
// starts to view slides
(function() {
  var deleted = false;
  slideshow.on('beforeShowSlide', function(slide) {
    if (deleted) return;
    var sheets = document.styleSheets, node;
    for (var i = 0; i < sheets.length; i++) {
      node = sheets[i].ownerNode;
      if (node.dataset["target"] !== "print-only") continue;
      node.parentNode.removeChild(node);
    }
    deleted = true;
  });
})();
(function() {
  "use strict"
  // Replace <script> tags in slides area to make them executable
  var scripts = document.querySelectorAll(
    '.remark-slides-area .remark-slide-container script'
  );
  if (!scripts.length) return;
  for (var i = 0; i < scripts.length; i++) {
    var s = document.createElement('script');
    var code = document.createTextNode(scripts[i].textContent);
    s.appendChild(code);
    var scriptAttrs = scripts[i].attributes;
    for (var j = 0; j < scriptAttrs.length; j++) {
      s.setAttribute(scriptAttrs[j].name, scriptAttrs[j].value);
    }
    scripts[i].parentElement.replaceChild(s, scripts[i]);
  }
})();
(function() {
  var links = document.getElementsByTagName('a');
  for (var i = 0; i < links.length; i++) {
    if (/^(https?:)?\/\//.test(links[i].getAttribute('href'))) {
      links[i].target = '_blank';
    }
  }
})();
// adds .remark-code-has-line-highlighted class to <pre> parent elements
// of code chunks containing highlighted lines with class .remark-code-line-highlighted
(function(d) {
  const hlines = d.querySelectorAll('.remark-code-line-highlighted');
  const preParents = [];
  const findPreParent = function(line, p = 0) {
    if (p > 1) return null; // traverse up no further than grandparent
    const el = line.parentElement;
    return el.tagName === "PRE" ? el : findPreParent(el, ++p);
  };

  for (let line of hlines) {
    let pre = findPreParent(line);
    if (pre && !preParents.includes(pre)) preParents.push(pre);
  }
  preParents.forEach(p => p.classList.add("remark-code-has-line-highlighted"));
})(document);</script>

<script>
slideshow._releaseMath = function(el) {
  var i, text, code, codes = el.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
};
slideshow._releaseMath(document);
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
